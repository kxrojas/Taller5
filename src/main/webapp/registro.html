<!DOCTYPE html>
<html lang="es">
<!-- Este es el encabezado el que contiene el menu -->
<head>
    <meta charset="UTF-8">
    <title>Registro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href=./styles/estiloR.css>
</head>

<body>
<!-- Este es el encabezado el que contiene el menu -->
<header>
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color:#FFD3B4">
        <a class="navbar-brand" href="index.html">
            <img src="./assets/V_(logo_2010).svg.png" alt="" width="70" height="60">
        </a>
        <ul class="nav">
            <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="Ingresar.html">Iniciar sesion</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="registro.html">Registrese</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="index.html">colecciones</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="index.html">Acerca de</a>
            </li>
        </ul>
    </nav>
</header>
<!-- Este es el formulario que tiene que hacer el ususario para registrarse -->
    <form class="form" id="create-user">
        <input class="cajas" type="text" placeholder="Name" required maxlength="30">
        <input name="username" id="username" class="cajas" type="text" placeholder="UserName" required maxlength="30">
        <input class="cajas" type="email" placeholder="Email" required maxlength="30">
        <input name="password"id="password" class="cajas" type="password" placeholder="Password" required maxlength="30">
        <select name="role" id="role">
            <option selected>Rol</option>
            <option value="comprador">Comprador</option>
            <option value="artista">Artista</option>
        </select>
        <input type="submit" class="btn" value="create-user">
        <p class="tengo-cuenta"><a href="Ingresar.html" class="tengo-cuenta">Ya tengo cuenta</a></p>
    </form>
<script>
    // Getting form by Id
    let createUserForm = document.getElementById("create-user");
    // Triggering event when submit
    createUserForm.onsubmit = async (e) => {
        e.preventDefault();
        var data = {
            "username": document.getElementById("username").value,
            "password": document.getElementById("password").value,
            "role": document.getElementById("role").value,
        };
        // Making the request
        let response = await fetch("./api/users", {
            method: "POST",
            headers: {
                'Content-type': 'application/json',
            },
            body: JSON.stringify(data)
        });
        // Extracting response as text
        let message = await response.json();
        alert(message);
        if(data.role===artist){window.location.href = "./perfilArtista.html";}
        else if(data.role===customer){window.location.href = "./perfilComprador.html";}
    };
</script>

</body>
</html>